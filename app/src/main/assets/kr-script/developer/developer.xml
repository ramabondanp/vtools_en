<?xml version="1.0" encoding="UTF-8" ?>
<root>
    <resource dir="file:///android_asset/kr-script/developer" />

    <group>
        <action>
            <title>@string:kr_dev_log_dump</title>
            <desc>@string:kr_dev_log_dump_desc</desc>
            <param name="path" value="/sdcard/logcat.log" />
            <set>
                p="$path"
                if [[ "$p" == "" ]]; then
                p="/sdcard/logcat.log"
                fi
                if [[ -f "$p" ]]; then
                rm "$p"
                fi
                logcat -d > "$p"
                if [[ -f "$p" ]]; then
                echo '@string:kr_dev_log_dump_ok ' $p
                fi
            </set>
        </action>
        <action>
            <title>@string:kr_dev_log_clear</title>
            <desc>@string:kr_dev_log_clear_desc</desc>
            <set>
                logcat -c
            </set>
        </action>
        <switch id="developer_remote_adb">
            <title>@string:kr_dev_remote_adb</title>
            <desc>@string:kr_dev_remote_adb_desc</desc>
            <summary sh="run adb_remote_summary.sh" />
            <get>run adb_remote_get.sh</get>
            <set>run adb_remote_set.sh</set>
        </switch>
        <switch id="developer_error_dialog" shell="hidden">
            <title>@string:kr_dev_hide_error</title>
            <desc>@string:kr_dev_hide_error_desc</desc>
            <get>run hide_errordialog_get.sh</get>
            <set>run hide_errordialog_set.sh</set>
        </switch>
        <switch id="developer_anr" shell="hidden">
            <title>@string:kr_dev_show_error</title>
            <desc>@string:kr_dev_show_error_desc</desc>
            <get>settings get secure show_first_crash_dialog_dev_option</get>
            <set>settings put secure show_first_crash_dialog_dev_option $state</set>
        </switch>
        <switch id="developer_anr" shell="hidden">
            <title>@string:kr_dev_show_anr</title>
            <desc>@string:kr_dev_show_anr_desc</desc>
            <get>run anr_get.sh</get>
            <set>run anr_set.sh</set>
        </switch>
        <switch id="show_touches" shell="hidden">
            <title>Show Touch Feedback</title>
            <desc>Show a small dot when touching the screen</desc>
            <get>settings get system show_touches</get>
            <set>settings put system show_touches $state</set>
        </switch>
    </group>

    <group title="@string:kr_dev_experimental">
        <picker value=" "
            target-sdk="29"
            auto-off="true"
            visible=". ./kr-script/common/android_q.sh">
            <title>@string:kr_dev_sandbox</title>
            <desc>@string:kr_dev_sandbox_desc</desc>
            <options>
                <option value="default">@string:kr_dev_sandbox_default</option>
                <option value="on">@string:kr_dev_sandbox_on</option>
                <option value="off">@string:kr_dev_sandbox_off</option>
            </options>
            <set>
                if [[ $state ]]; then
                echo '@string:kr_dev_sandbox_reboot_5s'
                sleep 5
                sm set-isolated-storage $state
                fi
            </set>
        </picker>
        <action min-sdk="26" max-sdk="33">
            <title>@string:kr_dev_hwui_render</title>
            <desc>@string:kr_dev_hwui_render_desc</desc>
            <summary sh="run hwui_render/summary.sh" />
            <param name="renderer"
                options-sh="run hwui_render/options.sh"
                value-sh="run hwui_render/get.sh" />
            <set>run hwui_render/set.sh</set>
        </action>
        <switch min-sdk="29" confirm="true">
            <title>@string:kr_dev_hwui_vulkan</title>
            <desc>@string:kr_dev_hwui_vulkan_desc</desc>
            <get>run hwui_vulkan/get.sh</get>
            <set>run hwui_vulkan/set.sh</set>
        </switch>
    </group>

    <group>
        <page activity="com.android.settings.APPLICATION_DEVELOPMENT_SETTINGS" title="@string:kr_dev_developer_settings" />
        <page activity="com.android.settings/.RunningServices" title="@string:kr_dev_running_service" />
        <page activity="com.android.settings/.Settings$MemorySettingsActivity" title="@string:kr_dev_mem_stat" />
    </group>

    <group title="@string:kr_dev_notch">
        <action>
            <title>@string:kr_dev_notch_no_notch</title>
            <desc>@string:kr_dev_notch_no_notch_desc</desc>
            <param name="type" value="hole" title="@string:kr_dev_notch_style">
                <option value="hole">@string:kr_dev_notch_style_hole</option>
            </param>
            <param name="os" title="@string:kr_dev_notch_os" value-sh="getprop ro.build.version.sdk">
                <option value="31">Android 12(SDK31)</option>
            </param>
            <set>
                run notch/apply.sh
            </set>
        </action>
    </group>

    <group>
        <switch title="Allow Installing Unknown Sources" max-sdk="35">
            <get>settings get secure install_non_market_apps</get>
            <get>settings put secure install_non_market_apps $state</get>
        </switch>
    </group>

    <group title="OTA"
        visible="binary_exist.sh update_engine_client">
        <action
            interruptible="false"
            warn="@string:kr_dev_ota_wran">
            <title>@string:kr_dev_ota</title>
            <desc>@string:kr_dev_ota_desc</desc>
            <summary>@string:kr_dev_ota_summary</summary>
            <params>
                <param title="@string:kr_dev_ota_file"
                    name="rom"
                    editable="true"
                    type="file"
                    suffix="zip"
                    required="true" />
            </params>
            <set>
                run ab_updater.sh
            </set>
        </action>
    </group>
</root>
